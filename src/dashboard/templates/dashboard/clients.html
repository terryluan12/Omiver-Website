{% extends 'dashboard/base.html' %}
{% load static %}
{% load component_tags %}

{% block header_title %}<h1 id="header-title">Client</h1>{% endblock %}
{% block header_actions %}
    <button class="DEMO-ACTION pill-generator-button">
        <div class="button-content">
            <div class="medical-cross">
                <div class="cross-horizontal"></div>
                <div class="cross-vertical"></div>
            </div>
            <span class="pill-text">Add Client</span>
        </div>
    </button>
{% endblock %}
{% block inner_styles %}
<link rel="stylesheet" href="{% static 'dashboard/clients/style.css' %}" />
{% endblock %}

{% block dashboard_content %}
<div id="info-block">
    <div class="description-info-block">
        <h4>Clients</h4>
        <p>Here you can manage your tasks, set preferences, and updates.</p>
    </div>
    <img class="cartoon" src="{% static 'dashboard/clients/banner.svg' %}" />
    <div class="ticket-info-block">
        <img src="{% static 'dashboard/clients/update.svg' %}" />
        <span>
            <h4>Last Update</h4>
            <p>20 Apr, 2025 - 12:00 pm</p>
        </span>
    </div>
    <div class="ticket-info-block">
        <img src="{% static 'dashboard/clients/client.svg' %}" />
        <span>
            <h4>Total Clients</h4>
            <p>3</p>
        </span>
    </div>
</div>

<div class="table-container">
    <table class="clients-table" id="clients-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Plan</th>
                <th>Date Registration</th>
                <th>Email</th>
                <th>Last Activity</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody hx-get="/api/clients" hx-trigger="load" hx-target="this" hx-swap="innerHTML">
            {% for profile in profiles %}
            <tr>
                <td>{{ profile.name }}</td>        
                <td><span class="plan-badge {{profile.plan|lower}}">{{ profile.plan }}</span></td>
                <td>{{ profile.registration_date }}</td>
                <td>{{ profile.email }}</td>
                <td>{{ profile.last_activity }}</td>
                <td><span class="status-badge {{ profile.status|lower }}">{{ profile.status_text }}</span></td>
                <td>
                    <div class="action-buttons">
                        <button class="DEMO-ACTION btn btn-sm btn-secondary" 
                                hx-get="/api/clients/{{ profile.id }}/edit" 
                                hx-target="#modal" 
                                hx-trigger="click">
                            Edit
                        </button>
                        {% comment %} <button class="btn btn-sm btn-danger" 
                                hx-delete="/api/clients/1" 
                                hx-target="closest tr" 
                                hx-swap="outerHTML" 
                                hx-confirm="Are you sure you want to delete this client?">
                            Delete
                        </button> {% endcomment %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Loading indicator -->
<div class="loading-indicator" id="loading" style="display: none;">
    <div class="spinner"></div>
    <p>Loading...</p>
</div>
{% component "demo_modal" / %}
{% endblock %}